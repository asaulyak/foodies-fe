import{r as o,h as w,j as e,b as N,S as v,u,g as R,a as $,i as W,o as T,M as y,k,l as P,s as B,B as C,m as F,n as I,e as D}from"./index-BVLjHrsE.js";import{R as L}from"./RecipeCard-CdigP2p-.js";import{P as z}from"./PathInfo-Bq3LJvpK.js";import"./index-BmVN0a0y.js";import"./index-rvdvgpiq.js";const M="_sectionTitle_1rons_1",U="_item_1rons_27",q="_list_1rons_49",g={sectionTitle:M,item:U,list:q},A=()=>{const[t,s]=o.useState([]),[n,l]=o.useState(null),[r,m]=o.useState(!0),p=o.useCallback(async()=>await w.get("/recipes/popular"));return o.useEffect(()=>{t.length||p().then(({data:a})=>{s(a)}).catch(a=>l(a.message)).finally(m(!1))},[p,t]),e.jsxs("section",{className:g.section,children:[e.jsx("h2",{className:g.sectionTitle,children:"Popular recipes"}),r&&e.jsx(N,{size:v.large}),n&&e.jsx("p",{children:"Something went wrong. Please try again after a few seconds."}),!!t.length&&!n&&!r&&e.jsx("ul",{className:g.list,children:t.map(a=>e.jsx(L,{recipe:a,className:g.item},a.id))})]})},H="_wrapper_gs8kw_1",J="_title_gs8kw_9",O="_list_gs8kw_29",Y="_item_gs8kw_41",Z="_imgWrapper_gs8kw_53",G="_img_gs8kw_53",K="_textWrapper_gs8kw_85",Q="_accentText_gs8kw_101",d={wrapper:H,title:J,list:O,item:Y,imgWrapper:Z,img:G,textWrapper:K,accentText:Q},V=({ingredients:t})=>e.jsxs("div",{className:d.wrapper,children:[e.jsx("h3",{className:d.title,children:"Ingredients"}),e.jsx("ul",{className:d.list,children:t.map(s=>e.jsxs("li",{className:d.item,children:[e.jsx("div",{className:d.imgWrapper,children:e.jsx("img",{className:d.img,src:s.image,alt:`Ingredient ${s.title}`,onError:({currentTarget:n})=>{n.onerror=null,n.src="https://placehold.co/60x60/BFBEBE/050505?text=Image"}})}),e.jsxs("div",{className:d.textWrapper,children:[e.jsx("p",{className:d.accentText,children:s.name}),e.jsx("p",{children:s.quantity||"quantity"})]})]},s.id))})]}),X="_wrapper_1p40s_1",ee="_infoSection_1p40s_9",se="_title_1p40s_19",te="_thumb_1p40s_41",ne="_info_1p40s_9",ae="_description_1p40s_85",ce="_btn_1p40s_103",ie="_btnWrapper_1p40s_143",re="_btnThumb_1p40s_163",oe="_text_1p40s_171",le="_accentText_1p40s_183",i={wrapper:X,infoSection:ee,title:se,thumb:te,info:ne,description:ae,btn:ce,btnWrapper:ie,btnThumb:re,text:oe,accentText:le},pe="_hero_6fawz_1",me="_imgWrapper_6fawz_9",f={hero:pe,imgWrapper:me},de=({image:t,title:s})=>e.jsx("div",{className:f.hero,children:e.jsx("div",{className:f.imgWrapper,children:e.jsx("img",{className:f.img,src:t||"",alt:`Dish ${s}`,onError:({currentTarget:n})=>{n.onerror=null,n.src="https://placehold.co/400x400/BFBEBE/050505?text=Image not found"},loading:"lazy"})})}),he=({children:t,id:s="",img:n="",title:l="Dish",category:r="Dish",time:m="0",description:p="Dish",authorName:a="John",authorAvatar:x=""})=>{const c=u(R),h=$(),E=W(),S=()=>{if(!c)return h(T(y.signin));E(`/user/${s}`)};return e.jsxs("div",{className:i.wrapper,children:[e.jsx(de,{image:n,title:l}),e.jsxs("div",{children:[e.jsxs("section",{className:i.infoSection,children:[e.jsx("h2",{className:i.title,children:l}),e.jsxs("div",{className:i.thumb,children:[e.jsx("p",{className:i.info,children:r}),e.jsxs("p",{className:i.info,children:[m," min"]})]}),e.jsx("p",{className:i.description,children:p}),e.jsx("button",{type:"button",className:i.btn,onClick:S,children:e.jsxs(e.Fragment,{children:[e.jsx("span",{className:i.btnWrapper,children:e.jsx("img",{src:x||"https://www.gravatar.com/avatar",alt:"User Avatar",onError:({currentTarget:b})=>{b.onerror=null,b.src="https://placehold.co/50x50/BFBEBE/050505?text=Image"}})}),e.jsxs("span",{className:i.btnThumb,children:[e.jsx("span",{className:i.text,children:"Created by:"}),e.jsx("span",{className:i.accentText,children:a})]})]})})]}),t]})]})},xe="_title_12xgv_1",_e="_list_12xgv_19",ue="_item_12xgv_39",ge="_btn_12xgv_47",_={title:xe,list:_e,item:ue,btn:ge},j=["Remove from favorites","Add to favorites"],je=({preparation:t,recipeId:s})=>{const n=$(),l=u(R),r=u(k),m=u(P),p=u(B),a=m.includes(s)?j[0]:j[1],x=c=>{if(!l||r!=null&&r.includes(401))return n(T(y.signin));if(c.target.disabled=!0,!m.includes(s)){n(F(s)).then(h=>{h.payload.type||(c.target.textContent=j[0])});return}n(I(s)).then(h=>{h.payload.type||(c.target.textContent=j[1])})};return e.jsxs("section",{className:_.wrapper,children:[e.jsx("h3",{className:_.title,children:"Recipe preparation"}),e.jsx("ul",{className:_.list,children:t.split(`
`).map((c,h)=>e.jsx("p",{className:_.item,children:c},`${Date.now()}-${h}`))}),e.jsx("div",{children:e.jsx(C,{disabled:p,onClick:x,className:_.btn,children:p?e.jsx(N,{}):a})})]})},fe=({changeBreadCrumbs:t})=>{const[s,n]=o.useState(null),[l,r]=o.useState(null),[m,p]=o.useState(!0),{id:a}=D();return o.useEffect(()=>{if(s&&a===s.id)return;(async c=>await w.get(`/recipes/${c}`))(a).then(({data:c})=>{n(c),t(c.title)}).catch(c=>r(c.message)).finally(p(!1))},[a,t,s]),e.jsxs(e.Fragment,{children:[l&&e.jsx("p",{children:"Something went wrong. Please try again after a few seconds."}),m?e.jsx(N,{size:v.large}):!!s&&!l&&e.jsxs(he,{id:s.id,img:s.thumb,title:s.title,category:s.category.name,time:s.time,description:s.description,authorName:s.user.name,authorAvatar:s.user.avatar,children:[e.jsx(V,{ingredients:s.ingredients}),e.jsx(je,{preparation:s.instructions,recipeId:s.id})]})]})},Ne="_section_jz1ql_1",be={section:Ne},ye=()=>{const[t,s]=o.useState("");return e.jsx("section",{className:be.section,children:e.jsxs("div",{className:"container",children:[e.jsx("h1",{className:"visually-hidden",children:"Recipe Page"}),e.jsx(z,{currentPageName:t}),e.jsx(fe,{changeBreadCrumbs:s}),e.jsx(A,{})]})})};export{ye as default};

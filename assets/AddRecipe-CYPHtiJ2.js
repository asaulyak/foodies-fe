import{j as e,f as j,r as o,I,g as V,i as je,k as x,l as Ne,m as ye,n as we,a as ve,u as R,p as Se,b as qe,s as Ce,q as Ie,t as Te,v as ke,C as L,S as B,B as Ae,w as Fe,h as K,x as J,P as $e,y as Re,z as Le}from"./index-C4BO1XQ9.js";const Ee="_form_mainTitle_1v3wr_1",ze="_section_1v3wr_5",De="_form_subTitle_1v3wr_13",Q={form_mainTitle:Ee,section:ze,form_subTitle:De},Oe="_form_c4bmb_1",Pe="_form_info_c4bmb_8",Ue="_field_title_c4bmb_8",Ve="_title_c4bmb_11",Be="_wrap_field_c4bmb_25",Qe="_wrapper_c4bmb_30",He="_wrap_btn_c4bmb_36",Me="_textarea_bottom_c4bmb_41",Ge="_input_bottom_c4bmb_44",Ke="_add_ingredients_c4bmb_57",Je="_cooking_controls_c4bmb_75",We="_circle_button_c4bmb_85",Xe="_time_display_c4bmb_96",Ye="_time_positive_c4bmb_99",Ze="_time_base_c4bmb_102",et="_clear_button_c4bmb_106",tt="_wrapper_btn_c4bmb_172",a={form:Oe,form_info:Pe,field_title:Ue,title:Ve,wrap_field:Be,wrapper:Qe,wrap_btn:He,textarea_bottom:Me,input_bottom:Ge,"css-13cymwt-control":"_css-13cymwt-control_c4bmb_47","css-1nmdiq5-menu":"_css-1nmdiq5-menu_c4bmb_54",add_ingredients:Ke,cooking_controls:Je,circle_button:We,time_display:Xe,time_positive:Ye,time_base:Ze,clear_button:et,wrapper_btn:tt},st="_form_file_17c7w_1",at="_input_file_17c7w_16",it="_custom_input_file_17c7w_22",nt="_label_upload_17c7w_25",rt="_upload_description_17c7w_33",ot="_file_info_17c7w_38",ct="_upload_file_17c7w_41",lt="_upload_img_block_17c7w_47",b={form_file:st,input_file:at,custom_input_file:it,label_upload:nt,upload_description:rt,file_info:ot,upload_file:ct,upload_img_block:lt},dt=({selectedImage:s,setSelectedImage:m,name:i,register:n=()=>{},errors:c})=>{const u=f=>{const p=f.target.files[0];p&&m(URL.createObjectURL(p))};return e.jsxs("div",{className:j(b.form_file,{[b.upload_file]:s}),children:[s&&e.jsx(e.Fragment,{children:e.jsx("div",{className:b.upload_img_block,children:e.jsx("img",{src:s,alt:"Uploaded Preview",width:"551"})})}),e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:"input-file",className:b.label_upload,children:e.jsxs("div",{className:b.file_info,children:[!s&&e.jsx("img",{src:"/foodies-fe/upload-file.png",alt:"upload-file",width:"64",height:"64",className:b.default_img}),e.jsx("span",{className:b.upload_description,children:s?"Upload another photo":"Upload a photo"})]})}),e.jsx("input",{name:i,type:"file",className:b.input_file,accept:"image/*",id:"input-file",...n(i,{onChange:u})})]}),c&&e.jsx("span",{className:"error-form",children:c.message})]})},_t="_input_form_1qgxm_1",mt={input_form:_t},W=({type:s,className:m,parentClassName:i,value:n,name:c,placeholder:u,id:f,onChange:p,disabled:N=!1,register:d=()=>{},error:h})=>{const _=g=>{p(g.target.value)};return e.jsxs("div",{className:i,children:[e.jsx("input",{id:f,type:s,name:c,placeholder:u,className:j([mt.input_form,m]),onChange:_,disabled:N,...d(c)}),h&&e.jsx("span",{className:"error-form",children:h.message})]})},ut="_textarea_jrnbg_1",pt="_wrapper_textarea_jrnbg_25",ht="_count_jrnbg_28",gt="_count_bold_jrnbg_38",E={textarea:ut,wrapper_textarea:pt,count:ht,count_bold:gt},X=({disabled:s=!1,type:m,className:i,parentClassName:n,value:c,name:u,placeholder:f,labelFor:p,labelText:N,id:d,maxLength:h,register:_,error:g,setText:y})=>{const[w,v]=o.useState(!1),T=r=>{const A=r.target;y(r.target.value),r.target.value.length>0&&!w&&v(!0),A&&k(A)},k=r=>{r.style.height="auto",r.style.height=`${r.scrollHeight}px`};return o.useEffect(()=>{const r=document.getElementById(d);r&&k(r)},[c,d]),e.jsxs("div",{className:n,children:[e.jsx("label",{htmlFor:p,className:"form-label",children:N}),e.jsxs("div",{className:E.wrapper_textarea,children:[e.jsx("textarea",{type:m,id:d,name:u,placeholder:f,className:j([E.textarea,i]),rows:1,value:c,maxLength:h,disabled:s,..._(u,{onChange:T})}),e.jsxs("div",{className:E.count,children:[e.jsx("span",{className:j({[E.count_bold]:w&&c}),children:c.length}),"/",h]})]}),g&&e.jsx("span",{className:"error-form",children:g.message})]})},bt=s=>s.ingredients.list,ft=s=>s.areas.list,xt="_list_ingredients_1tguz_1",jt="_card_ingredients_1tguz_7",Nt="_image_item_1tguz_14",yt="_card_info_1tguz_24",wt="_name_1tguz_39",vt="_button_1tguz_43",S={list_ingredients:xt,card_ingredients:jt,image_item:Nt,card_info:yt,name:wt,button:vt},St=({list:s,handleIngredientsDelete:m})=>e.jsx("ul",{className:S.list_ingredients,children:s.map(i=>e.jsxs("li",{className:S.card_ingredients,children:[e.jsxs("div",{className:S.image_item,children:[" ",e.jsx("img",{src:i.image,alt:i.name})]})," ",e.jsxs("div",{className:S.card_info,children:[e.jsx("div",{className:S.name,children:e.jsx("span",{children:i.name})}),e.jsx("span",{children:i.quantity})]}),e.jsx("button",{type:"button",className:S.button,onClick:()=>m(i.id),children:e.jsx(I,{iconId:"close",width:16,stroke:"#050505",height:16})})]},i.id))}),qt=V().shape({image:je().test("required","Image is required",s=>s&&s.length>0).test("fileSize","File size is too large",s=>s&&s[0]&&s[0].size<=5e6),title:x().required("The title field is required"),description:x().required("The description field is required"),preparation:x().required("The preparation field is required"),category:V().shape({value:x().required("Category is required"),label:x()}).nullable().required("Category is required"),area:V().shape({value:x().required("Area is required"),label:x()}).nullable().required("Area is required"),time:Ne().min(1,"Time needs to be over than 0").required("Time is required"),ingredients:ye().min(1,"At least one ingredient is required").required("Ingredients are required")}),Ct=()=>{const{register:s,handleSubmit:m,control:i,formState:{errors:n},setValue:c,getValues:u,reset:f}=we({resolver:Fe(qt),defaultValues:{time:0,ingredients:[]}}),[p,N]=o.useState(null);o.useState(null);const[d,h]=o.useState(null);o.useState(null);const[_,g]=o.useState(0),[y,w]=o.useState([]),[v,T]=o.useState(null),[k,r]=o.useState({}),[A,z]=o.useState(!1),[Y,H]=o.useState(""),[Z,M]=o.useState(""),F=ve(),D=R(Se),$=R(bt),O=R(ft),ee=qe(),te=R(Ce);o.useEffect(()=>{F(Ie()),F(Te()),F(ke())},[F]);const se=D==null?void 0:D.map(t=>({value:t.id,label:t.name})),ae=$==null?void 0:$.map(t=>({value:t.id,label:t.name})),ie=O==null?void 0:O.map(t=>({value:t.id,label:t.name})),ne=async t=>{const{area:l,category:q,description:U,image:me,ingredients:ue,preparation:pe,time:he,title:ge}=t,be=me[0],G=new FormData;G.append("thumb",be);const fe=ue.map(C=>({id:C.id,quantity:C.quantity}));try{const C=await K.post("/recipes/thumb",G,{headers:{"Content-Type":"multipart/form-data"}}),xe={title:ge,instructions:pe,description:U,thumb:C.data,time:he.toString(),categoryId:q.value,areaId:l.value,ingredients:fe},It=await K.post("/recipes",xe);J.success("New recipe added successfully!"),ee(`/user/${te.id}`)}catch{J.error("Something went wrong, please try again.")}},re=()=>{H(""),M(""),h(null),w([]),N(null),T(null),r({}),z(!1),g(0),f()},oe=()=>{g(t=>t+10)},ce=()=>{_>1&&g(t=>t-10)},le=j(a.time_display,{[a.time_positive]:_>1,[a.time_base]:_<=1}),de=()=>{if(r(v?{}:{message:"The quantity field is required"}),z(!d),d&&v&&y.findIndex(t=>t.id===d.value)===-1){const t=$.find(l=>l.id===d.value);w([...y,{...t,quantity:v}]),c("ingredients",[...u("ingredients"),{...t,quantity:v}])}},_e=t=>{const l=y.filter(q=>q.id!==t);w(q=>q.filter(U=>U.id!==t)),c("ingredients",l)},P={option:(t,l)=>({...t,backgroundColor:l.isSelected?"#bfbebe29":"#fff",color:l.isSelected?"#1a1a1a":t.color,"&:active":{backgroundColor:"#c0c0c0"},"&:hover":{backgroundColor:"#bfbebe29"}})};return e.jsxs("form",{onSubmit:m(ne),className:a.form,children:[e.jsx(dt,{name:"image",selectedImage:p,setSelectedImage:N,register:s,errors:n.image}),e.jsxs("div",{className:a.form_info,children:[e.jsx(W,{type:"text",id:"",placeholder:"The name of the recipe",parentClassName:a.field_title,className:a.title,register:s,error:n.title,name:"title"}),e.jsx(X,{name:"description",type:"text",value:Y,id:"description",placeholder:"Enter a description of the dish",maxLength:200,setText:H,register:s,error:n.description}),e.jsxs("div",{className:a.wrapper,children:[e.jsxs("div",{className:a.wrap_field,children:[e.jsxs("div",{className:"field",children:[e.jsx("p",{className:"form-label",children:"category"}),e.jsx(L,{name:"category",control:i,defaultValue:null,render:({field:t})=>e.jsx(B,{...t,options:se,placeholder:"Select a category",onChange:l=>t.onChange(l),styles:P})}),n.category&&e.jsx("span",{className:"error-form",children:n.category.message})]}),e.jsxs("div",{className:a.cooking_time,children:[e.jsx("h3",{className:"form-label",children:"COOKING TIME"}),e.jsx("div",{className:a.cooking_controls,children:e.jsx(L,{name:"time",control:i,render:({field:t})=>e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:a.circle_button,onClick:()=>{ce(),t.onChange(_-10)},disabled:_<=0,children:e.jsx(I,{iconId:"minus",width:24,stroke:"#050505",height:24})}),e.jsxs("span",{className:le,children:[_," min"]}),e.jsx("button",{type:"button",className:a.circle_button,onClick:()=>{oe(),t.onChange(_+10)},children:e.jsx(I,{iconId:"plus",width:24,stroke:"#050505",height:24})})]})})}),n.time&&e.jsx("span",{className:"error-form",children:n.time.message})]})]}),e.jsx("div",{className:a.wrap_field,children:e.jsxs("div",{className:"field",children:[e.jsx("p",{className:"form-label",children:"Area"}),e.jsx(L,{name:"area",control:i,defaultValue:null,render:({field:t})=>e.jsx(B,{...t,options:ie,placeholder:"Select an area",styles:P,onChange:l=>t.onChange(l)})}),n.area&&e.jsx("span",{className:"error-form",children:n.area.message})]})}),e.jsxs("div",{children:[e.jsxs("div",{className:a.wrap_field,children:[e.jsxs("div",{className:"field",children:[e.jsx("p",{className:"form-label",children:"Ingredients"}),e.jsx(B,{value:d,onChange:h,options:ae,placeholder:"Add the ingredient",styles:P}),A&&e.jsx("span",{className:"error-form",children:"Select an ingredient"})]}),e.jsx(W,{type:"text",name:"quantity",placeholder:"Enter quantity",onChange:T,error:k})]}),e.jsxs("button",{type:"button",className:a.add_ingredients,onClick:de,children:["Add ingredient",e.jsx(I,{iconId:"plus",width:22,stroke:"#050505",height:22})]}),e.jsx(L,{name:"ingredients",control:i,render:({field:t})=>e.jsxs(e.Fragment,{children:[n.ingredients&&e.jsx("span",{className:"error-form",children:n.ingredients.message}),e.jsx(St,{list:y,handleIngredientsDelete:_e})]})})]})]}),e.jsx(X,{type:"text",name:"preparation",id:"recipe-preparation",placeholder:"Enter recipe",labelFor:"recipe-preparation",labelText:"Recipe Preparation",maxLength:200,parentClassName:a.textarea_bottom,className:a.input_bottom,value:Z,setText:M,register:s,error:n.preparation}),e.jsxs("div",{className:a.wrap_btn,children:[e.jsx("button",{className:j(a.circle_button,a.clear_button),type:"button",onClick:re,children:e.jsx(I,{iconId:"trash",width:20,stroke:"#050505",height:20})}),e.jsx(Ae,{type:"submit",variant:"color",children:"Publish",className:a.form_btn})]})]})]})},kt=()=>e.jsx(e.Fragment,{children:e.jsxs("section",{className:j(Q.section,"container"),children:[e.jsx($e,{currentPageName:"Add recipe"}),e.jsx(Re,{className:Q.form_mainTitle,children:"Add recipe"}),e.jsx(Le,{className:Q.form_subTitle,children:"Reveal your culinary art, share your favorite recipe and create gastronomic masterpieces with us."}),e.jsx(Ct,{})]})});export{kt as default};

import{a as R,j as e,I as M,H as A,J as F,r as _,N as T,h as I,i as U,B as D,d as z,b as y,S as O,e as H,u as L,K as J,g as K,s as Q,O as Y,P as Z,Q as E,E as $,o as q,M as G}from"./index-dDieGT1G.js";import{P as V}from"./Pagination-C2UM7XOF.js";import{M as k}from"./index-DlHEtYGf.js";import{M as X,S as ee}from"./SubTitle-BiQQXDmZ.js";import{P as se}from"./PathInfo-DiXZb0q8.js";import"./index-5TlkmqWu.js";const re="_userWrap_18tjm_1",te="_userImgWrap_18tjm_17",ae="_userImg_18tjm_17",ne="_userImgBtn_18tjm_26",ie="_userName_18tjm_41",ce="_userDetails_18tjm_47",oe="_userDetailInfo_18tjm_52",le="_userDetailsInfoNumber_18tjm_60",me="_userImgInput_18tjm_101",ue="_userImgBtnIcon_18tjm_104",o={userWrap:re,userImgWrap:te,userImg:ae,userImgBtn:ne,userName:ie,userDetails:ce,userDetailInfo:oe,userDetailsInfoNumber:le,userImgInput:me,userImgBtnIcon:ue},pe=({id:c,name:r,email:x,avatar:l,totalFavoritesRecipes:t,totalFollowers:m,totalFollowings:s,totalRecipes:a,isOwner:n})=>{const u=R(),f=async i=>{const p=i.target.files[0];if(!p)return;const j=new FormData;j.append("avatar",p),await u(A(j)).unwrap().then(()=>u(F(c)))};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:o.userWrap,children:[e.jsxs("div",{className:o.userImgWrap,children:[e.jsx("img",{className:o.userImg,src:l,alt:""}),n?e.jsxs("div",{children:[e.jsx("input",{id:"file-upload",type:"file",className:o.userImgInput,onChange:f}),e.jsx("label",{htmlFor:"file-upload",className:o.userImgBtn,children:e.jsx(M,{iconId:"plus",className:o.userImgBtnIcon,width:17,height:16})})]}):e.jsx(e.Fragment,{})]}),e.jsx("p",{className:o.userName,children:r}),e.jsxs("ul",{className:o.userDetails,children:[e.jsxs("li",{className:o.userDetailInfo,children:["Email:",e.jsx("span",{className:o.userDetailsInfoNumber,children:x})]}),e.jsxs("li",{className:o.userDetailInfo,children:["Added recipes:",e.jsx("span",{className:o.userDetailsInfoNumber,children:a})]}),n?e.jsxs("li",{className:o.userDetailInfo,children:["Favorites:",e.jsx("span",{className:o.userDetailsInfoNumber,children:t})]}):e.jsx(e.Fragment,{}),e.jsxs("li",{className:o.userDetailInfo,children:["Followers:",e.jsx("span",{className:o.userDetailsInfoNumber,children:m})]}),n?e.jsxs("li",{className:o.userDetailInfo,children:["Following:",e.jsx("span",{className:o.userDetailsInfoNumber,children:s})]}):e.jsx(e.Fragment,{})]})]})})},de="_containerUser_1me76_1",he="_logOutBtn_1me76_7",ge="_loaderWrapper_1me76_14",_e="_userInfoButtonWrapper_1me76_26",fe="_userWrapper_1me76_33",P={containerUser:de,logOutBtn:he,loaderWrapper:ge,userInfoButtonWrapper:_e,userWrapper:fe},Ie="_tabsContainer_xs9rm_1",xe="_tabsContainerButton_xs9rm_4",je="_tabsList_xs9rm_14",ve="_tabItem_xs9rm_19",we="_tabItemActive_xs9rm_31",B={tabsContainer:Ie,tabsContainerButton:xe,tabsList:je,tabItem:ve,tabItemActive:we},Ne="_recipePreviewItem_1n4yo_1",be="_recipePreviewImg_1n4yo_7",Pe="_recipePreviewOverlay_1n4yo_13",Be="_recipePreviewIcon_1n4yo_19",ye="_recipePreviewWrapperIcon_1n4yo_22",De="_recipePreviewTitle_1n4yo_27",Ce="_recipePreviewDescription_1n4yo_34",We="_recipePreviewBtn_1n4yo_40",N={recipePreviewItem:Ne,recipePreviewImg:be,recipePreviewOverlay:Pe,recipePreviewIcon:Be,recipePreviewWrapperIcon:ye,recipePreviewTitle:De,recipePreviewDescription:Ce,recipePreviewBtn:We},Le=({title:c,description:r,thumb:x,id:l,isOwner:t,onDelete:m,activeTab:s})=>{const[a,n]=_.useState(50),[u,f]=_.useState(13);_.useEffect(()=>{const d=()=>{const v=window.innerWidth;v<768?(n(50),f(13)):v>=768&&v<1440?(n(160),f(40)):(n(160),f(70))};return d(),window.addEventListener("resize",d),()=>{window.removeEventListener("resize",d)}},[]);const i=async()=>{try{s==="recipes"?(await I.delete(`/recipes/${l}`),m(l)):s==="favorites"&&(await I.delete(`/recipes/${l}/favorites`),m(l))}catch(d){toast.error(d.response.data.message)}},p=(r==null?void 0:r.length)>a?r.substring(0,a)+"...":r,j=(c==null?void 0:c.length)>u?c.substring(0,u)+"...":c;return e.jsxs("li",{className:N.recipePreviewItem,children:[e.jsx("img",{className:N.recipePreviewImg,src:x,alt:""}),e.jsxs("div",{className:N.recipePreviewOverlay,children:[e.jsx("p",{className:N.recipePreviewTitle,children:j}),e.jsx("p",{className:N.recipePreviewDescription,children:p})]}),e.jsxs("div",{className:N.recipePreviewWrapperIcon,children:[e.jsx(T,{className:N.recipePreviewBtn,to:`/recipe/${l}`,children:e.jsx(k,{})}),t?e.jsx("button",{onClick:i,className:N.recipePreviewBtn,children:e.jsx(M,{iconId:"trash",className:N.recipePreviewIcon,width:18,height:18,stroke:"#050505",children:" "})}):e.jsx(e.Fragment,{})]})]})},Fe="_userCardItem_1thgs_1",Se="_userName_1thgs_20",$e="_userDescription_1thgs_35",Ee="_userInfo_1thgs_49",Re="_avatarWrapper_1thgs_58",Me="_recipeImageList_1thgs_72",Oe="_imageWrapper_1thgs_81",ke="_imageItem_1thgs_93",Ae="_mainBtn_1thgs_97",Te="_secondaryBtn_1thgs_113",g={userCardItem:Fe,userName:Se,userDescription:$e,userInfo:Ee,avatarWrapper:Re,recipeImageList:Me,imageWrapper:Oe,imageItem:ke,mainBtn:Ae,secondaryBtn:Te},b=["follow","following"],Ue=({avatar:c,id:r,name:x,recipes:l,activeTab:t,ownsRecipes:m,onDelete:s=null})=>{const a=U(),n=t==="followers"?b[0]:b[1],u=async i=>{if(i.target.textContent===b[0]&&t==="followers"){await I.post("/users/subscribe",{subscribedTo:r}).then(p=>{i.target.textContent=b[1]});return}if(i.target.textContent===b[1]&&t==="followers"){await I.delete(`/users/unsubscribe/${r}`).then(p=>{i.target.textContent=b[0],s(r)});return}if(i.target.textContent===b[1]&&t==="following"){await I.delete(`/users/unsubscribe/${r}`).then(p=>{s(r)});return}},f=()=>{a(`/user/${r}`)};return e.jsxs("li",{className:g.userCardItem,children:[e.jsxs("div",{className:g.userInfo,children:[e.jsx("div",{className:g.avatarWrapper,children:e.jsx("img",{className:g.userAvatarImage,src:c||"",alt:"Avatar",onError:({currentTarget:i})=>{i.onerror=null,i.src="https://placehold.co/85x85/BFBEBE/050505?text=Avatar"},loading:"lazy"})}),e.jsxs("div",{className:g.userDetails,children:[e.jsxs("h3",{className:g.userName,children:[x,"r"]}),e.jsx("p",{className:g.userDescription,children:`Own recipes: ${m}`}),e.jsx(D,{onClick:u,className:g.mainBtn,children:n})]})]}),e.jsx("ul",{className:g.recipeImageList,children:l.map(i=>e.jsx("li",{className:g.imageItem,children:e.jsx("div",{className:g.imageWrapper,children:e.jsx("img",{className:g.recipeImage,src:i.thumb,alt:"Recipe img",onError:({currentTarget:p})=>{p.onerror=null,p.src="https://placehold.co/100x100/BFBEBE/050505?text=Recipe"},loading:"lazy"},i.id)})},i.id))}),e.jsx(D,{onClick:f,className:g.secondaryBtn,children:e.jsx(k,{})})]})},ze=({isOwner:c,id:r,totalRecipes:x,totalFollowers:l,totalFollowings:t,totalFavoritesRecipes:m})=>{const[s,a]=_.useState("recipes"),[n,u]=_.useState([]),[f,i]=_.useState(!0),[p]=z();let j=p.get("page")||1;_.useEffect(()=>{(async()=>{i(!0);try{let w;c?s==="following"||s==="favorites"?w=(await I.get(`/users/${s}/`)).data:w=(await I.get(`/users/${s}/${r}`,{params:{limit:9,page:j}})).data:w=(await I.get(`/users/${s}/${r}`)).data,u(w?w.data:[])}catch(w){toast.error(w.response.data.message),u([])}finally{i(!1)}})()},[s,j,r,c,l]),_.useEffect(()=>{a("recipes")},[r]);const d=h=>{u([]),a(h)},v={recipes:c?"My Recipes":"Recipes",favorites:"My Favorite",followers:"Followers",following:"Following"},C=h=>{u(w=>w.filter(W=>W.id!==h))},S=c?["recipes","favorites","followers","following"]:["recipes","followers"];return e.jsxs("div",{className:B.tabsContainer,children:[e.jsx("div",{className:B.tabsContainerButton,children:e.jsx("div",{className:B.tabsList,children:S.map(h=>e.jsx("button",{className:`${B.tabItem} ${s===h?B.tabItemActive:""}`,onClick:()=>d(h),children:v[h]},h))})}),e.jsx("div",{className:"list-items",children:f?e.jsx(y,{size:O.medium}):(n==null?void 0:n.length)===0?e.jsx("p",{children:"Nothing has been added to your recipes list yet. Please browse our recipes and add your favorites for easy access in the future."}):e.jsx("ul",{children:n==null?void 0:n.map(h=>s==="recipes"||s==="favorites"?e.jsx(Le,{...h,isOwner:c,onDelete:C,activeTab:s},h.id):e.jsx(Ue,{...h,isOwner:c,onDelete:C,activeTab:s},h.id))})}),e.jsx(V,{total:s==="recipes"?x:s==="favorites"?m:s==="followers"?l:t,limit:9})]})},qe=()=>{const[c,r]=_.useState(!1),[x,l]=_.useState(!1),{id:t}=H(),m=R(),s=L(J),a=L(K),n=L(Q),u=L(Y);_.useEffect(()=>{r(n)},[n]);const f=d=>{m(q(d))},i=async()=>{try{r(!0),await I.post("/users/subscribe/",{subscribedTo:t}),l(!0)}catch(d){$.error(d.response.data.message)}finally{r(!1),m(F(t))}},p=async()=>{try{r(!0),await I.delete(`/users/unsubscribe/${t}`),l(!1)}catch(d){$.error(d.response.data.message)}finally{r(!1),m(F(t))}},j=()=>{f(G.logout)};return _.useEffect(()=>{t&&m(F(t)),a||m(Z()),(async()=>{try{const{data:v}=await I.get("/users/following"),C=v.data.some(S=>S.id===t);l(C)}catch(v){$.error(v.response.data.message)}})()},[m,t,a]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"container",children:[e.jsx(se,{currentPageName:"Profile"}),e.jsx(X,{children:" Profile"}),e.jsx(ee,{children:"Reveal your culinary art, share your favorite recipe and create gastronomic masterpieces with us."}),e.jsxs("div",{className:P.userWrapper,children:[e.jsxs("div",{className:P.userInfoButtonWrapper,children:[u||n?e.jsx("div",{className:P.loaderWrapper,children:e.jsx(y,{size:O.large})}):e.jsx(pe,{...s,isOwner:(a==null?void 0:a.id)===t}),(a==null?void 0:a.id)===t?e.jsx(D,{onClick:j,className:P.logOutBtn,children:"Log Out"}):x?e.jsx(D,{onClick:p,className:P.logOutBtn,children:c?e.jsx(y,{color:E.white}):"Following"}):e.jsx(D,{onClick:i,className:P.logOutBtn,children:c?e.jsx(y,{color:E.white}):"Follow"})]}),n?e.jsx(y,{}):e.jsx(ze,{totalRecipes:s==null?void 0:s.totalRecipes,totalFollowers:s==null?void 0:s.totalFollowers,totalFollowings:s==null?void 0:s.totalFollowings,totalFavoritesRecipes:s==null?void 0:s.totalFavoritesRecipes,isOwner:(a==null?void 0:a.id)===t,id:t})]})]})})};export{qe as default};

import{j as e,c as x,I as S,r,w as H,x as Ne,y as j,z as ye,A as we,C as ke,a as Se,u as R,k as qe,i as Ce,f as Ie,D as Te,E as $e,H as E,B as Ae,$ as Fe,J as Le,h as W,K as X,t as Re,b as Ee,S as De}from"./index-CqsNzJ6P.js";import{S as Q}from"./react-select.esm-BiwBMT1x.js";import{c as ze}from"./categories.selectors-w5pH7G6F.js";const Oe="_form_mainTitle_1v3wr_1",Ue="_section_1v3wr_5",Pe="_form_subTitle_1v3wr_13",M={form_mainTitle:Oe,section:Ue,form_subTitle:Pe},Ve="_form_ckuea_1",Be="_form_info_ckuea_8",He="_field_title_ckuea_8",Qe="_title_ckuea_11",Me="_wrap_field_ckuea_25",Ke="_wrapper_ckuea_30",Ge="_wrap_btn_ckuea_36",Je="_textarea_bottom_ckuea_41",We="_input_bottom_ckuea_44",Xe="_add_ingredients_ckuea_57",Ye="_cooking_controls_ckuea_75",Ze="_circle_button_ckuea_85",et="_time_display_ckuea_96",tt="_time_positive_ckuea_99",st="_time_base_ckuea_102",at="_form_btn_ckuea_105",it="_spinner_active_ckuea_109",nt="_spinner_ckuea_109",rt="_clear_button_ckuea_119",ot="_wrapper_btn_ckuea_185",a={form:Ve,form_info:Be,field_title:He,title:Qe,wrap_field:Me,wrapper:Ke,wrap_btn:Ge,textarea_bottom:Je,input_bottom:We,"css-13cymwt-control":"_css-13cymwt-control_ckuea_47","css-1nmdiq5-menu":"_css-1nmdiq5-menu_ckuea_54",add_ingredients:Xe,cooking_controls:Ye,circle_button:Ze,time_display:et,time_positive:tt,time_base:st,form_btn:at,spinner_active:it,spinner:nt,clear_button:rt,wrapper_btn:ot},ct="_form_file_vd4c0_1",lt="_input_file_vd4c0_16",dt="_custom_input_file_vd4c0_22",_t="_label_upload_vd4c0_25",mt="_upload_description_vd4c0_34",ut="_file_info_vd4c0_39",pt="_upload_file_vd4c0_47",ht="_upload_img_block_vd4c0_53",ft="_file_error_vd4c0_65",g={form_file:ct,input_file:lt,custom_input_file:dt,label_upload:_t,upload_description:mt,file_info:ut,upload_file:pt,upload_img_block:ht,file_error:ft},gt=({selectedImage:s,setSelectedImage:m,name:i,register:n=()=>{},errors:c})=>{const u=b=>{const p=b.target.files[0];p&&m(URL.createObjectURL(p))};return e.jsxs("div",{className:x(g.form_file,{[g.upload_file]:s}),children:[s&&e.jsx(e.Fragment,{children:e.jsx("div",{className:g.upload_img_block,children:e.jsx("img",{src:s,alt:"Uploaded Preview",width:"551"})})}),e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:"input-file",className:g.label_upload,children:e.jsxs("div",{className:g.file_info,children:[!s&&e.jsx(S,{iconId:"camera",width:64,height:64}),e.jsx("span",{className:g.upload_description,children:s?"Upload another photo":"Upload a photo"})]})}),e.jsx("input",{name:i,type:"file",className:g.input_file,accept:"image/*",id:"input-file",...n(i,{onChange:u})})]}),c&&e.jsx("span",{className:x([g.file_error,"error-form"]),children:c.message})]})},xt="_input_form_yiuq1_1",bt={input_form:xt},Y=({type:s,className:m,parentClassName:i,value:n,name:c,placeholder:u,id:b,onChange:p,disabled:v=!1,register:d=()=>{},error:h})=>{const _=f=>{p(f.target.value)};return e.jsxs("div",{className:i,children:[e.jsx("input",{id:b,type:s,name:c,placeholder:u,className:x([bt.input_form,m]),onChange:_,disabled:v,...d(c)}),h&&e.jsx("span",{className:"error-form",children:h.message})]})},jt="_textarea_1i2sz_1",vt="_wrapper_textarea_1i2sz_29",Nt="_count_1i2sz_32",yt="_count_bold_1i2sz_42",D={textarea:jt,wrapper_textarea:vt,count:Nt,count_bold:yt},Z=({disabled:s=!1,type:m,className:i,parentClassName:n,value:c,name:u,placeholder:b,labelFor:p,labelText:v,id:d,maxLength:h,register:_,error:f,setText:N})=>{const[y,w]=r.useState(!1),I=o=>{const $=o.target;N(o.target.value),o.target.value.length>0&&!y&&w(!0),$&&T($)},T=o=>{o.style.height="auto",o.style.height=`${o.scrollHeight}px`};return r.useEffect(()=>{const o=document.getElementById(d);o&&T(o)},[c,d]),e.jsxs("div",{className:n,children:[e.jsx("label",{htmlFor:p,className:"form-label",children:v}),e.jsxs("div",{className:D.wrapper_textarea,children:[e.jsx("textarea",{type:m,id:d,name:u,placeholder:b,className:x([D.textarea,i]),rows:1,value:c,maxLength:h,disabled:s,..._(u,{onChange:I})}),e.jsxs("div",{className:D.count,children:[e.jsx("span",{className:x({[D.count_bold]:y&&c}),children:c.length}),"/",h]})]}),f&&e.jsx("span",{className:"error-form",children:f.message})]})},wt=s=>s.ingredients.list,kt=s=>s.areas.list,St="_list_ingredients_e3o9d_1",qt="_card_ingredients_e3o9d_7",Ct="_image_item_e3o9d_14",It="_card_info_e3o9d_24",Tt="_name_e3o9d_39",$t="_button_e3o9d_43",k={list_ingredients:St,card_ingredients:qt,image_item:Ct,card_info:It,name:Tt,button:$t},At=({list:s,handleIngredientsDelete:m})=>e.jsx("ul",{className:k.list_ingredients,children:s.map(i=>e.jsxs("li",{className:k.card_ingredients,children:[e.jsxs("div",{className:k.image_item,children:[" ",e.jsx("img",{src:i.image,alt:i.name})]})," ",e.jsxs("div",{className:k.card_info,children:[e.jsx("div",{className:k.name,children:e.jsx("span",{children:i.name})}),e.jsx("span",{children:i.quantity})]}),e.jsx("button",{type:"button",className:k.button,onClick:()=>m(i.id),children:e.jsx(S,{iconId:"close",width:16,stroke:"#050505",height:16})})]},i.id))}),Ft=H().shape({image:Ne().test("required","Image is required",s=>s&&s.length>0).test("fileSize","File size is too large",s=>s&&s[0]&&s[0].size<=5e6),title:j().required("The title field is required"),description:j().required("The description field is required"),preparation:j().required("The preparation field is required"),category:H().shape({value:j().required("Category is required"),label:j()}).nullable().required("Category is required"),area:H().shape({value:j().required("Area is required"),label:j()}).nullable().required("Area is required"),time:ye().min(1,"Time needs to be over than 0").required("Time is required"),ingredients:we().min(1,"At least one ingredient is required").required("Ingredients are required")}),Lt=()=>{const{register:s,handleSubmit:m,control:i,formState:{errors:n},setValue:c,getValues:u,reset:b}=ke({resolver:Le(Ft),defaultValues:{time:0,ingredients:[]}}),[p,v]=r.useState(null);r.useState(null);const[d,h]=r.useState(null);r.useState(null);const[_,f]=r.useState(0),[N,y]=r.useState([]),[w,I]=r.useState(null),[T,o]=r.useState({}),[$,z]=r.useState(!1),[ee,K]=r.useState(""),[te,G]=r.useState(""),A=Se(),O=R(ze),F=R(wt),U=R(kt),se=qe(),ae=R(Ce),[L,P]=r.useState(!1);r.useEffect(()=>{A(Ie()),A(Te()),A($e())},[A]);const ie=O==null?void 0:O.map(t=>({value:t.id,label:t.name})),ne=F==null?void 0:F.map(t=>({value:t.id,label:t.name})),re=U==null?void 0:U.map(t=>({value:t.id,label:t.name})),oe=async t=>{const{area:l,category:q,description:B,image:pe,ingredients:he,preparation:fe,time:ge,title:xe}=t,be=pe[0],J=new FormData;J.append("thumb",be);const je=he.map(C=>({id:C.id,quantity:C.quantity}));try{P(!0);const C=await W.post("/recipes/thumb",J,{headers:{"Content-Type":"multipart/form-data"}}),ve={title:xe,instructions:fe,description:B,thumb:C.data,time:ge.toString(),categoryId:q.value,areaId:l.value,ingredients:je},Rt=await W.post("/recipes",ve);X.success("New recipe added successfully!"),se(`/user/${ae.id}`)}catch{P(!1),X.error("Something went wrong, please try again.")}finally{P(!1)}},ce=()=>{K(""),G(""),h(null),y([]),v(null),I(null),o({}),z(!1),f(0),b()},le=()=>{f(t=>t+10)},de=()=>{_>1&&f(t=>t-10)},_e=x(a.time_display,{[a.time_positive]:_>1,[a.time_base]:_<=1}),me=()=>{if(o(w?{}:{message:"The quantity field is required"}),z(!d),d&&w&&N.findIndex(t=>t.id===d.value)===-1){const t=F.find(l=>l.id===d.value);y([...N,{...t,quantity:w}]),c("ingredients",[...u("ingredients"),{...t,quantity:w}])}},ue=t=>{const l=N.filter(q=>q.id!==t);y(q=>q.filter(B=>B.id!==t)),c("ingredients",l)},V={option:(t,l)=>({...t,backgroundColor:l.isSelected?"#bfbebe29":"#fff",color:l.isSelected?"#1a1a1a":t.color,"&:active":{backgroundColor:"#c0c0c0"},"&:hover":{backgroundColor:"#bfbebe29"}})};return e.jsxs("form",{onSubmit:m(oe),className:a.form,children:[e.jsx(gt,{name:"image",selectedImage:p,setSelectedImage:v,register:s,errors:n.image}),e.jsxs("div",{className:a.form_info,children:[e.jsx(Y,{type:"text",id:"",placeholder:"The name of the recipe",parentClassName:a.field_title,className:a.title,register:s,error:n.title,name:"title"}),e.jsx(Z,{name:"description",type:"text",value:ee,id:"description",placeholder:"Enter a description of the dish",maxLength:200,setText:K,register:s,error:n.description}),e.jsxs("div",{className:a.wrapper,children:[e.jsxs("div",{className:a.wrap_field,children:[e.jsxs("div",{className:"field",children:[e.jsx("p",{className:"form-label",children:"category"}),e.jsx(E,{name:"category",control:i,defaultValue:null,render:({field:t})=>e.jsx(Q,{...t,options:ie,placeholder:"Select a category",onChange:l=>t.onChange(l),styles:V})}),n.category&&e.jsx("span",{className:"error-form",children:n.category.message})]}),e.jsxs("div",{className:a.cooking_time,children:[e.jsx("h3",{className:"form-label",children:"COOKING TIME"}),e.jsx("div",{className:a.cooking_controls,children:e.jsx(E,{name:"time",control:i,render:({field:t})=>e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:a.circle_button,onClick:()=>{de(),t.onChange(_-10)},disabled:_<=0,children:e.jsx(S,{iconId:"minus",width:24,stroke:"#050505",height:24})}),e.jsxs("span",{className:_e,children:[_," min"]}),e.jsx("button",{type:"button",className:a.circle_button,onClick:()=>{le(),t.onChange(_+10)},children:e.jsx(S,{iconId:"plus",width:24,stroke:"#050505",height:24})})]})})}),n.time&&e.jsx("span",{className:"error-form",children:n.time.message})]})]}),e.jsx("div",{className:a.wrap_field,children:e.jsxs("div",{className:"field",children:[e.jsx("p",{className:"form-label",children:"Area"}),e.jsx(E,{name:"area",control:i,defaultValue:null,render:({field:t})=>e.jsx(Q,{...t,options:re,placeholder:"Select an area",styles:V,onChange:l=>t.onChange(l)})}),n.area&&e.jsx("span",{className:"error-form",children:n.area.message})]})}),e.jsxs("div",{children:[e.jsxs("div",{className:a.wrap_field,children:[e.jsxs("div",{className:"field",children:[e.jsx("p",{className:"form-label",children:"Ingredients"}),e.jsx(Q,{value:d,onChange:h,options:ne,placeholder:"Add the ingredient",styles:V}),$&&e.jsx("span",{className:"error-form",children:"Select an ingredient"})]}),e.jsx(Y,{type:"text",name:"quantity",placeholder:"Enter quantity",onChange:I,error:T})]}),e.jsxs("button",{type:"button",className:a.add_ingredients,onClick:me,children:["Add ingredient",e.jsx(S,{iconId:"plus",width:22,stroke:"#050505",height:22})]}),e.jsx(E,{name:"ingredients",control:i,render:({field:t})=>e.jsxs(e.Fragment,{children:[n.ingredients&&e.jsx("span",{className:"error-form",children:n.ingredients.message}),e.jsx(At,{list:N,handleIngredientsDelete:ue})]})})]})]}),e.jsx(Z,{type:"text",name:"preparation",id:"recipe-preparation",placeholder:"Enter recipe",labelFor:"recipe-preparation",labelText:"Recipe Preparation",maxLength:200,parentClassName:a.textarea_bottom,className:a.input_bottom,value:te,setText:G,register:s,error:n.preparation}),e.jsxs("div",{className:a.wrap_btn,children:[e.jsx("button",{className:x(a.circle_button,a.clear_button),type:"button",onClick:ce,children:e.jsx(S,{iconId:"trash",width:20,stroke:"#050505",height:20})}),e.jsxs(Ae,{type:"submit",variant:"color",className:`${a.form_btn} ${L?a.spinner_active:""}`,children:[!L&&e.jsx("span",{children:"Publish"}),L&&e.jsx("span",{className:a.spinner,children:e.jsx(Fe,{visible:L,width:"120",color:"#bfbebe",ariaLabel:"infinity-spin-loading"})})]})]})]})]})},Ot=()=>e.jsx(e.Fragment,{children:e.jsxs("section",{className:x(M.section,"container"),children:[e.jsx(Re,{currentPageName:"Add recipe"}),e.jsx(Ee,{className:M.form_mainTitle,children:"Add recipe"}),e.jsx(De,{className:M.form_subTitle,children:"Reveal your culinary art, share your favorite recipe and create gastronomic masterpieces with us."}),e.jsx(Lt,{})]})});export{Ot as default};

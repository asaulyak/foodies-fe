import{a as E,j as e,I as z,H as O,J as L,r as _,N as A,h as I,i as T,B as y,d as q,b as D,S as R,e as U,u as k,K as H,g as J,s as K,O as Q,P as Y,Q as $,E as S,o as Z,M as G}from"./index-PUPZeyS0.js";import{P as V}from"./Pagination-B-hOcYGf.js";import{M}from"./index-Bo3jPXsN.js";import{M as X,S as ee}from"./SubTitle-kd9VbgCL.js";import{P as se}from"./PathInfo-CpaC60tC.js";import"./index-BY0sqmy9.js";const re="_userWrap_1tqpz_1",te="_userImgWrap_1tqpz_17",ae="_userImg_1tqpz_17",ne="_userImgBtn_1tqpz_26",ie="_userName_1tqpz_41",ce="_userDetails_1tqpz_47",oe="_userDetailInfo_1tqpz_52",le="_userDetailsInfoNumber_1tqpz_60",pe="_userImgInput_1tqpz_101",ue="_userImgBtnIcon_1tqpz_104",o={userWrap:re,userImgWrap:te,userImg:ae,userImgBtn:ne,userName:ie,userDetails:ce,userDetailInfo:oe,userDetailsInfoNumber:le,userImgInput:pe,userImgBtnIcon:ue},me=({id:c,name:r,email:x,avatar:l,totalFavoritesRecipes:t,totalFollowers:p,totalFollowings:s,totalRecipes:a,isOwner:n})=>{const u=E(),g=async i=>{const m=i.target.files[0];if(!m)return;const v=new FormData;v.append("avatar",m),await u(O(v)).unwrap().then(()=>u(L(c)))};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:o.userWrap,children:[e.jsxs("div",{className:o.userImgWrap,children:[e.jsx("img",{className:o.userImg,src:l,alt:""}),n?e.jsxs("div",{children:[e.jsx("input",{id:"file-upload",type:"file",className:o.userImgInput,onChange:g}),e.jsx("label",{htmlFor:"file-upload",className:o.userImgBtn,children:e.jsx(z,{iconId:"plus",className:o.userImgBtnIcon,width:17,height:16})})]}):e.jsx(e.Fragment,{})]}),e.jsx("p",{className:o.userName,children:r}),e.jsxs("ul",{className:o.userDetails,children:[e.jsxs("li",{className:o.userDetailInfo,children:["Email:",e.jsx("span",{className:o.userDetailsInfoNumber,children:x})]}),e.jsxs("li",{className:o.userDetailInfo,children:["Added recipes:",e.jsx("span",{className:o.userDetailsInfoNumber,children:a})]}),n?e.jsxs("li",{className:o.userDetailInfo,children:["Favorites:",e.jsx("span",{className:o.userDetailsInfoNumber,children:t})]}):e.jsx(e.Fragment,{}),e.jsxs("li",{className:o.userDetailInfo,children:["Followers:",e.jsx("span",{className:o.userDetailsInfoNumber,children:p})]}),n?e.jsxs("li",{className:o.userDetailInfo,children:["Following:",e.jsx("span",{className:o.userDetailsInfoNumber,children:s})]}):e.jsx(e.Fragment,{})]})]})})},de="_containerUser_1me76_1",he="_logOutBtn_1me76_7",fe="_loaderWrapper_1me76_14",_e="_userInfoButtonWrapper_1me76_26",ge="_userWrapper_1me76_33",P={containerUser:de,logOutBtn:he,loaderWrapper:fe,userInfoButtonWrapper:_e,userWrapper:ge},Ie="_tabsContainer_xs9rm_1",xe="_tabsContainerButton_xs9rm_4",ve="_tabsList_xs9rm_14",je="_tabItem_xs9rm_19",we="_tabItemActive_xs9rm_31",B={tabsContainer:Ie,tabsContainerButton:xe,tabsList:ve,tabItem:je,tabItemActive:we},Ne="_recipePreviewItem_1snpi_1",be="_recipePreviewImg_1snpi_7",Pe="_recipePreviewOverlay_1snpi_13",Be="_recipePreviewIcon_1snpi_19",De="_recipePreviewWrapperIcon_1snpi_22",ye="_recipePreviewTitle_1snpi_27",Ce="_recipePreviewDescription_1snpi_34",We="_recipePreviewBtn_1snpi_40",N={recipePreviewItem:Ne,recipePreviewImg:be,recipePreviewOverlay:Pe,recipePreviewIcon:Be,recipePreviewWrapperIcon:De,recipePreviewTitle:ye,recipePreviewDescription:Ce,recipePreviewBtn:We},ke=({title:c,description:r,thumb:x,id:l,isOwner:t,onDelete:p,activeTab:s})=>{const[a,n]=_.useState(50),[u,g]=_.useState(13);_.useEffect(()=>{const d=()=>{const j=window.innerWidth;j<768?(n(50),g(13)):j>=768&&j<1440?(n(160),g(40)):(n(160),g(70))};return d(),window.addEventListener("resize",d),()=>{window.removeEventListener("resize",d)}},[]);const i=async()=>{try{s==="recipes"?(await I.delete(`/recipes/${l}`),p(l)):s==="favorites"&&(await I.delete(`/recipes/${l}/favorites`),p(l))}catch(d){toast.error(d.response.data.message)}},m=(r==null?void 0:r.length)>a?r.substring(0,a)+"...":r,v=(c==null?void 0:c.length)>u?c.substring(0,u)+"...":c;return e.jsxs("li",{className:N.recipePreviewItem,children:[e.jsx("img",{className:N.recipePreviewImg,src:x,alt:""}),e.jsxs("div",{className:N.recipePreviewOverlay,children:[e.jsx("p",{className:N.recipePreviewTitle,children:v}),e.jsx("p",{className:N.recipePreviewDescription,children:m})]}),e.jsxs("div",{className:N.recipePreviewWrapperIcon,children:[e.jsx(A,{className:N.recipePreviewBtn,to:`/recipe/${l}`,children:e.jsx(M,{})}),t?e.jsx("button",{onClick:i,className:N.recipePreviewBtn,children:e.jsx(z,{iconId:"trash",className:N.recipePreviewIcon,width:18,height:18,stroke:"#050505",children:" "})}):e.jsx(e.Fragment,{})]})]})},Le="_userCardItem_1fkkn_1",Fe="_userName_1fkkn_20",Se="_userDescription_1fkkn_35",$e="_userInfo_1fkkn_49",Ee="_avatarWrapper_1fkkn_58",ze="_recipeImageList_1fkkn_72",Re="_imageWrapper_1fkkn_81",Me="_imageItem_1fkkn_93",Oe="_mainBtn_1fkkn_97",Ae="_secondaryBtn_1fkkn_113",f={userCardItem:Le,userName:Fe,userDescription:Se,userInfo:$e,avatarWrapper:Ee,recipeImageList:ze,imageWrapper:Re,imageItem:Me,mainBtn:Oe,secondaryBtn:Ae},b=["follow","following"],Te=({avatar:c,id:r,name:x,recipes:l,activeTab:t,ownsRecipes:p,onDelete:s=null})=>{const a=T(),n=t==="followers"?b[0]:b[1],u=async i=>{if(i.target.textContent===b[0]&&t==="followers"){await I.post("/users/subscribe",{subscribedTo:r}).then(m=>{i.target.textContent=b[1]});return}if(i.target.textContent===b[1]&&t==="followers"){await I.delete(`/users/unsubscribe/${r}`).then(m=>{i.target.textContent=b[0],s(r)});return}if(i.target.textContent===b[1]&&t==="following"){await I.delete(`/users/unsubscribe/${r}`).then(m=>{s(r)});return}},g=()=>{a(`/user/${r}`)};return e.jsxs("li",{className:f.userCardItem,children:[e.jsxs("div",{className:f.userInfo,children:[e.jsx("div",{className:f.avatarWrapper,children:e.jsx("img",{className:f.userAvatarImage,src:c||"",alt:"Avatar",onError:({currentTarget:i})=>{i.onerror=null,i.src="https://placehold.co/85x85/BFBEBE/050505?text=Avatar"},loading:"lazy"})}),e.jsxs("div",{className:f.userDetails,children:[e.jsxs("h3",{className:f.userName,children:[x,"r"]}),e.jsx("p",{className:f.userDescription,children:`Own recipes: ${p}`}),e.jsx(y,{onClick:u,className:f.mainBtn,children:n})]})]}),e.jsx("ul",{className:f.recipeImageList,children:l.map(i=>e.jsx("li",{className:f.imageItem,children:e.jsx("div",{className:f.imageWrapper,children:e.jsx("img",{className:f.recipeImage,src:i.thumb,alt:"Recipe img",onError:({currentTarget:m})=>{m.onerror=null,m.src="https://placehold.co/100x100/BFBEBE/050505?text=Recipe"},loading:"lazy"},i.id)})},i.id))}),e.jsx(y,{onClick:g,className:f.secondaryBtn,children:e.jsx(M,{})})]})},qe=({isOwner:c,id:r,totalRecipes:x,totalFollowers:l,totalFollowings:t,totalFavoritesRecipes:p})=>{const[s,a]=_.useState("recipes"),[n,u]=_.useState([]),[g,i]=_.useState(!0),[m]=q();let v=m.get("page")||1;_.useEffect(()=>{(async()=>{i(!0);try{let w;c?s==="following"||s==="favorites"?w=(await I.get(`/users/${s}/`)).data:w=(await I.get(`/users/${s}/${r}`,{params:{limit:9,page:v}})).data:w=(await I.get(`/users/${s}/${r}`)).data,u(w?w.data:[])}catch(w){toast.error(w.response.data.message),u([])}finally{i(!1)}})()},[s,v,r,c,l]),_.useEffect(()=>{a("recipes")},[r]);const d=h=>{u([]),a(h)},j={recipes:c?"My Recipes":"Recipes",favorites:"My Favorite",followers:"Followers",following:"Following"},C=h=>{u(w=>w.filter(W=>W.id!==h))},F=c?["recipes","favorites","followers","following"]:["recipes","followers"];return e.jsxs("div",{className:B.tabsContainer,children:[e.jsx("div",{className:B.tabsContainerButton,children:e.jsx("div",{className:B.tabsList,children:F.map(h=>e.jsx("button",{className:`${B.tabItem} ${s===h?B.tabItemActive:""}`,onClick:()=>d(h),children:j[h]},h))})}),e.jsx("div",{className:"list-items",children:g?e.jsx(D,{size:R.medium}):(n==null?void 0:n.length)===0?e.jsx("p",{children:"Nothing has been added to your recipes list yet. Please browse our recipes and add your favorites for easy access in the future."}):e.jsx("ul",{children:n==null?void 0:n.map(h=>s==="recipes"||s==="favorites"?e.jsx(ke,{...h,isOwner:c,onDelete:C,activeTab:s},h.id):e.jsx(Te,{...h,isOwner:c,onDelete:C,activeTab:s},h.id))})}),e.jsx(V,{total:s==="recipes"?x:s==="favorites"?p:s==="followers"?l:t,limit:9})]})},Ze=()=>{const[c,r]=_.useState(!1),[x,l]=_.useState(!1),{id:t}=U(),p=E(),s=k(H),a=k(J),n=k(K),u=k(Q);_.useEffect(()=>{r(n)},[n]);const g=d=>{p(Z(d))},i=async()=>{try{r(!0),await I.post("/users/subscribe/",{subscribedTo:t}),l(!0)}catch(d){S.error(d.response.data.message)}finally{r(!1),p(L(t))}},m=async()=>{try{r(!0),await I.delete(`/users/unsubscribe/${t}`),l(!1)}catch(d){S.error(d.response.data.message)}finally{r(!1),p(L(t))}},v=()=>{g(G.logout)};return _.useEffect(()=>{t&&p(L(t)),a||p(Y()),(async()=>{try{const{data:j}=await I.get("/users/following"),C=j.data.some(F=>F.id===t);l(C)}catch(j){S.error(j.response.data.message)}})()},[p,t,a]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"container",children:[e.jsx(se,{currentPageName:"Profile"}),e.jsx(X,{children:" Profile"}),e.jsx(ee,{children:"Reveal your culinary art, share your favorite recipe and create gastronomic masterpieces with us."}),e.jsxs("div",{className:P.userWrapper,children:[e.jsxs("div",{className:P.userInfoButtonWrapper,children:[u||n?e.jsx("div",{className:P.loaderWrapper,children:e.jsx(D,{size:R.large})}):e.jsx(me,{...s,isOwner:(a==null?void 0:a.id)===t}),(a==null?void 0:a.id)===t?e.jsx(y,{onClick:v,className:P.logOutBtn,children:"Log Out"}):x?e.jsx(y,{onClick:m,className:P.logOutBtn,children:c?e.jsx(D,{color:$.white}):"Following"}):e.jsx(y,{onClick:i,className:P.logOutBtn,children:c?e.jsx(D,{color:$.white}):"Follow"})]}),n?e.jsx(D,{}):e.jsx(qe,{totalRecipes:s==null?void 0:s.totalRecipes,totalFollowers:s==null?void 0:s.totalFollowers,totalFollowings:s==null?void 0:s.totalFollowings,totalFavoritesRecipes:s==null?void 0:s.totalFavoritesRecipes,isOwner:(a==null?void 0:a.id)===t,id:t})]})]})})};export{Ze as default};

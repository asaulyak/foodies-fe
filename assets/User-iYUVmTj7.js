import{a as E,j as e,I as R,H as O,J as L,r as _,N as A,h as I,i as T,B as y,d as q,c as U,b as D,S as z,e as H,u as k,K as J,g as K,s as Q,O as Y,P as Z,Q as $,E as S,o as G,M as V}from"./index-CWFMWRfZ.js";import{P as X}from"./Pagination-90FBLMoG.js";import{M}from"./index-BusUQHOt.js";import{M as ee,S as se}from"./SubTitle-CDPsefDx.js";import{P as re}from"./PathInfo-DhQsqkHc.js";const te="_userWrap_1tqpz_1",ae="_userImgWrap_1tqpz_17",ne="_userImg_1tqpz_17",ie="_userImgBtn_1tqpz_26",ce="_userName_1tqpz_41",oe="_userDetails_1tqpz_47",le="_userDetailInfo_1tqpz_52",pe="_userDetailsInfoNumber_1tqpz_60",ue="_userImgInput_1tqpz_101",me="_userImgBtnIcon_1tqpz_104",o={userWrap:te,userImgWrap:ae,userImg:ne,userImgBtn:ie,userName:ce,userDetails:oe,userDetailInfo:le,userDetailsInfoNumber:pe,userImgInput:ue,userImgBtnIcon:me},de=({id:c,name:r,email:x,avatar:l,totalFavoritesRecipes:t,totalFollowers:p,totalFollowings:s,totalRecipes:a,isOwner:n})=>{const u=E(),f=async i=>{const m=i.target.files[0];if(!m)return;const v=new FormData;v.append("avatar",m),await u(O(v)).unwrap().then(()=>u(L(c)))};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:o.userWrap,children:[e.jsxs("div",{className:o.userImgWrap,children:[e.jsx("img",{className:o.userImg,src:l,alt:""}),n?e.jsxs("div",{children:[e.jsx("input",{id:"file-upload",type:"file",className:o.userImgInput,onChange:f}),e.jsx("label",{htmlFor:"file-upload",className:o.userImgBtn,children:e.jsx(R,{iconId:"plus",className:o.userImgBtnIcon,width:17,height:16})})]}):e.jsx(e.Fragment,{})]}),e.jsx("p",{className:o.userName,children:r}),e.jsxs("ul",{className:o.userDetails,children:[e.jsxs("li",{className:o.userDetailInfo,children:["Email:",e.jsx("span",{className:o.userDetailsInfoNumber,children:x})]}),e.jsxs("li",{className:o.userDetailInfo,children:["Added recipes:",e.jsx("span",{className:o.userDetailsInfoNumber,children:a})]}),n?e.jsxs("li",{className:o.userDetailInfo,children:["Favorites:",e.jsx("span",{className:o.userDetailsInfoNumber,children:t})]}):e.jsx(e.Fragment,{}),e.jsxs("li",{className:o.userDetailInfo,children:["Followers:",e.jsx("span",{className:o.userDetailsInfoNumber,children:p})]}),n?e.jsxs("li",{className:o.userDetailInfo,children:["Following:",e.jsx("span",{className:o.userDetailsInfoNumber,children:s})]}):e.jsx(e.Fragment,{})]})]})})},he="_containerUser_1me76_1",ge="_logOutBtn_1me76_7",_e="_loaderWrapper_1me76_14",fe="_userInfoButtonWrapper_1me76_26",Ie="_userWrapper_1me76_33",P={containerUser:he,logOutBtn:ge,loaderWrapper:_e,userInfoButtonWrapper:fe,userWrapper:Ie},xe="_tabsContainer_1u0gh_1",ve="_tabsContainerButton_1u0gh_4",je="_tabsList_1u0gh_17",we="_tabItem_1u0gh_21",Ne="_tabItemActive_1u0gh_33",be="_listReceipes_1u0gh_53",B={tabsContainer:xe,tabsContainerButton:ve,tabsList:je,tabItem:we,tabItemActive:Ne,listReceipes:be},Pe="_recipePreviewItem_1snpi_1",Be="_recipePreviewImg_1snpi_7",De="_recipePreviewOverlay_1snpi_13",ye="_recipePreviewIcon_1snpi_19",Ce="_recipePreviewWrapperIcon_1snpi_22",We="_recipePreviewTitle_1snpi_27",ke="_recipePreviewDescription_1snpi_34",Le="_recipePreviewBtn_1snpi_40",N={recipePreviewItem:Pe,recipePreviewImg:Be,recipePreviewOverlay:De,recipePreviewIcon:ye,recipePreviewWrapperIcon:Ce,recipePreviewTitle:We,recipePreviewDescription:ke,recipePreviewBtn:Le},Fe=({title:c,description:r,thumb:x,id:l,isOwner:t,onDelete:p,activeTab:s})=>{const[a,n]=_.useState(50),[u,f]=_.useState(13);_.useEffect(()=>{const d=()=>{const j=window.innerWidth;j<768?(n(50),f(13)):j>=768&&j<1440?(n(160),f(40)):(n(160),f(70))};return d(),window.addEventListener("resize",d),()=>{window.removeEventListener("resize",d)}},[]);const i=async()=>{try{s==="recipes"?(await I.delete(`/recipes/${l}`),p(l)):s==="favorites"&&(await I.delete(`/recipes/${l}/favorites`),p(l))}catch(d){toast.error(d.response.data.message)}},m=(r==null?void 0:r.length)>a?r.substring(0,a)+"...":r,v=(c==null?void 0:c.length)>u?c.substring(0,u)+"...":c;return e.jsxs("li",{className:N.recipePreviewItem,children:[e.jsx("img",{className:N.recipePreviewImg,src:x,alt:""}),e.jsxs("div",{className:N.recipePreviewOverlay,children:[e.jsx("p",{className:N.recipePreviewTitle,children:v}),e.jsx("p",{className:N.recipePreviewDescription,children:m})]}),e.jsxs("div",{className:N.recipePreviewWrapperIcon,children:[e.jsx(A,{className:N.recipePreviewBtn,to:`/recipe/${l}`,children:e.jsx(M,{})}),t?e.jsx("button",{onClick:i,className:N.recipePreviewBtn,children:e.jsx(R,{iconId:"trash",className:N.recipePreviewIcon,width:18,height:18,stroke:"#050505",children:" "})}):e.jsx(e.Fragment,{})]})]})},Se="_userCardItem_1fkkn_1",$e="_userName_1fkkn_20",Ee="_userDescription_1fkkn_35",Re="_userInfo_1fkkn_49",ze="_avatarWrapper_1fkkn_58",Me="_recipeImageList_1fkkn_72",Oe="_imageWrapper_1fkkn_81",Ae="_imageItem_1fkkn_93",Te="_mainBtn_1fkkn_97",qe="_secondaryBtn_1fkkn_113",g={userCardItem:Se,userName:$e,userDescription:Ee,userInfo:Re,avatarWrapper:ze,recipeImageList:Me,imageWrapper:Oe,imageItem:Ae,mainBtn:Te,secondaryBtn:qe},b=["follow","following"],Ue=({avatar:c,id:r,name:x,recipes:l,activeTab:t,ownsRecipes:p,onDelete:s=null})=>{const a=T(),n=t==="followers"?b[0]:b[1],u=async i=>{if(i.target.textContent===b[0]&&t==="followers"){await I.post("/users/subscribe",{subscribedTo:r}).then(m=>{i.target.textContent=b[1]});return}if(i.target.textContent===b[1]&&t==="followers"){await I.delete(`/users/unsubscribe/${r}`).then(m=>{i.target.textContent=b[0],s(r)});return}if(i.target.textContent===b[1]&&t==="following"){await I.delete(`/users/unsubscribe/${r}`).then(m=>{s(r)});return}},f=()=>{a(`/user/${r}`)};return e.jsxs("li",{className:g.userCardItem,children:[e.jsxs("div",{className:g.userInfo,children:[e.jsx("div",{className:g.avatarWrapper,children:e.jsx("img",{className:g.userAvatarImage,src:c||"",alt:"Avatar",onError:({currentTarget:i})=>{i.onerror=null,i.src="https://placehold.co/85x85/BFBEBE/050505?text=Avatar"},loading:"lazy"})}),e.jsxs("div",{className:g.userDetails,children:[e.jsxs("h3",{className:g.userName,children:[x,"r"]}),e.jsx("p",{className:g.userDescription,children:`Own recipes: ${p}`}),e.jsx(y,{onClick:u,className:g.mainBtn,children:n})]})]}),e.jsx("ul",{className:g.recipeImageList,children:l.map(i=>e.jsx("li",{className:g.imageItem,children:e.jsx("div",{className:g.imageWrapper,children:e.jsx("img",{className:g.recipeImage,src:i.thumb,alt:"Recipe img",onError:({currentTarget:m})=>{m.onerror=null,m.src="https://placehold.co/100x100/BFBEBE/050505?text=Recipe"},loading:"lazy"},i.id)})},i.id))}),e.jsx(y,{onClick:f,className:g.secondaryBtn,children:e.jsx(M,{})})]})},He=({isOwner:c,id:r,totalRecipes:x,totalFollowers:l,totalFollowings:t,totalFavoritesRecipes:p})=>{const[s,a]=_.useState("recipes"),[n,u]=_.useState([]),[f,i]=_.useState(!0),[m]=q();let v=m.get("page")||1;_.useEffect(()=>{(async()=>{i(!0);try{let w;c?s==="following"||s==="favorites"?w=(await I.get(`/users/${s}/`)).data:w=(await I.get(`/users/${s}/${r}`,{params:{limit:9,page:v}})).data:w=(await I.get(`/users/${s}/${r}`)).data,u(w?w.data:[])}catch(w){toast.error(w.response.data.message),u([])}finally{i(!1)}})()},[s,v,r,c,l]),_.useEffect(()=>{a("recipes")},[r]);const d=h=>{u([]),a(h)},j={recipes:c?"My Recipes":"Recipes",favorites:"My Favorite",followers:"Followers",following:"Following"},C=h=>{u(w=>w.filter(W=>W.id!==h))},F=c?["recipes","favorites","followers","following"]:["recipes","followers"];return e.jsxs("div",{className:B.tabsContainer,children:[e.jsx("div",{className:B.tabsContainerButton,children:e.jsx("div",{className:B.tabsList,children:F.map(h=>e.jsx("button",{className:`${B.tabItem} ${s===h?B.tabItemActive:""}`,onClick:()=>d(h),children:j[h]},h))})}),e.jsx("div",{className:U("list-items",B.listReceipes),children:f?e.jsx(D,{size:z.medium}):(n==null?void 0:n.length)===0?e.jsx("p",{children:"Nothing has been added to your recipes list yet. Please browse our recipes and add your favorites for easy access in the future."}):e.jsx("ul",{children:n==null?void 0:n.map(h=>s==="recipes"||s==="favorites"?e.jsx(Fe,{...h,isOwner:c,onDelete:C,activeTab:s},h.id):e.jsx(Ue,{...h,isOwner:c,onDelete:C,activeTab:s},h.id))})}),e.jsx(X,{total:s==="recipes"?x:s==="favorites"?p:s==="followers"?l:t,limit:9})]})},Ge=()=>{const[c,r]=_.useState(!1),[x,l]=_.useState(!1),{id:t}=H(),p=E(),s=k(J),a=k(K),n=k(Q),u=k(Y);_.useEffect(()=>{r(n)},[n]);const f=d=>{p(G(d))},i=async()=>{try{r(!0),await I.post("/users/subscribe/",{subscribedTo:t}),l(!0)}catch(d){S.error(d.response.data.message)}finally{r(!1),p(L(t))}},m=async()=>{try{r(!0),await I.delete(`/users/unsubscribe/${t}`),l(!1)}catch(d){S.error(d.response.data.message)}finally{r(!1),p(L(t))}},v=()=>{f(V.logout)};return _.useEffect(()=>{t&&p(L(t)),a||p(Z()),(async()=>{try{const{data:j}=await I.get("/users/following"),C=j.data.some(F=>F.id===t);l(C)}catch(j){S.error(j.response.data.message)}})()},[p,t,a]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"container",children:[e.jsx(re,{currentPageName:"Profile"}),e.jsx(ee,{children:" Profile"}),e.jsx(se,{children:"Reveal your culinary art, share your favorite recipe and create gastronomic masterpieces with us."}),e.jsxs("div",{className:P.userWrapper,children:[e.jsxs("div",{className:P.userInfoButtonWrapper,children:[u||n?e.jsx("div",{className:P.loaderWrapper,children:e.jsx(D,{size:z.large})}):e.jsx(de,{...s,isOwner:(a==null?void 0:a.id)===t}),(a==null?void 0:a.id)===t?e.jsx(y,{onClick:v,className:P.logOutBtn,children:"Log Out"}):x?e.jsx(y,{onClick:m,className:P.logOutBtn,children:c?e.jsx(D,{color:$.white}):"Following"}):e.jsx(y,{onClick:i,className:P.logOutBtn,children:c?e.jsx(D,{color:$.white}):"Follow"})]}),n?e.jsx(D,{}):e.jsx(He,{totalRecipes:s==null?void 0:s.totalRecipes,totalFollowers:s==null?void 0:s.totalFollowers,totalFollowings:s==null?void 0:s.totalFollowings,totalFavoritesRecipes:s==null?void 0:s.totalFavoritesRecipes,isOwner:(a==null?void 0:a.id)===t,id:t})]})]})})};export{Ge as default};
